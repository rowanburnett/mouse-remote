<!DOCTYPE html>
<html style="width: 100%; height: 100%;">
  <head>
    <title>Mouse Remote</title>
  </head>
  <body style="width: 100%; height: 100%;">
    <h1>Mouse Remote</h1>
    <div id="box" style="border: solid black 1px; width: 100%; height: 100%;"></div>
  </body>
</html>

<script src="/socket.io/socket.io.js"></script>
<script>
var socket = io();

function startup() {
  const box = document.getElementById('box');
  box.addEventListener('touchmove', handleMove);
  box.addEventListener('touchstart', handleStart);
  box.addEventListener('click', (evt) => {
    socket.emit('mouseClicked')
  })
}

document.addEventListener('DOMContentLoaded', startup);

function handleStart(evt) {
  socket.emit('touchStarted')
}

function handleMove(evt) {
  console.log('moved')
  evt.preventDefault();

  let touchPoint = evt.touches.item(0);
  let touchX = touchPoint.screenX / screen.width;
  let touchY = touchPoint.screenY / screen.height;

  if (evt.touches.length === 1) {
    socket.emit('mouseMoved', [touchX, touchY]);
  }
  if (evt.touches.length > 1) {
    socket.emit('mouseScrolled', [touchX, touchY]);
  }
}

</script>
